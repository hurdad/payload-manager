syntax = "proto3";

package payload.manager.v1;

/*
  Shared enums/tables for Payload Manager APIs.

  Keep this file focused on definitions reused across service, config,
  and metadata protos.
*/

/*
  Storage tier ordered roughly from fastest/least durable â†’ slowest/most durable.
*/
enum Tier {
  TIER_UNSPECIFIED = 0;
  TIER_GPU = 1;
  TIER_RAM = 2;
  TIER_DISK = 3;
  TIER_OBJECT = 4; // S3 / MinIO
}

/*
  Compression algorithm applied at rest.
*/
enum Compression {
  COMPRESSION_UNSPECIFIED = 0;
  COMPRESSION_NONE = 1;
  COMPRESSION_LZ4 = 2;
  COMPRESSION_ZSTD = 3;
}

/*
  Logical format of the payload.
*/
enum PayloadFormat {
  PAYLOAD_FORMAT_UNSPECIFIED = 0;
  PAYLOAD_FORMAT_RAW = 1;
  PAYLOAD_FORMAT_ARROW_IPC = 2;
  PAYLOAD_FORMAT_PARQUET = 3;
  PAYLOAD_FORMAT_FLATBUFFER = 4;
}

/*
  Canonical lifecycle state shared across all Payload Manager APIs.

  State transitions are monotonic; terminal states are EXPIRED and DELETED.
*/
enum PayloadState {
  PAYLOAD_STATE_UNSPECIFIED = 0;

  // Reserved/created but not visible to readers yet.
  PAYLOAD_STATE_ALLOCATED = 1;

  // Visible and available for readers.
  PAYLOAD_STATE_ACTIVE = 2;

  // In progress of becoming durable (e.g. spill to disk/object storage).
  PAYLOAD_STATE_SPILLING = 3;

  // Durable copy exists.
  PAYLOAD_STATE_DURABLE = 4;

  // In progress of movement/eviction between tiers.
  PAYLOAD_STATE_EVICTING = 5;

  // Explicit client delete requested and in progress.
  PAYLOAD_STATE_DELETING = 6;

  // TTL elapsed.
  PAYLOAD_STATE_EXPIRED = 7;

  // Terminal: payload bytes/placement removed.
  PAYLOAD_STATE_DELETED = 8;
}

/*
  Per-payload eviction priority.
*/
enum EvictionPriority {
  EVICTION_PRIORITY_UNSPECIFIED = 0;
  EVICTION_PRIORITY_LOW = 1;
  EVICTION_PRIORITY_NORMAL = 2;
  EVICTION_PRIORITY_HIGH = 3;
  EVICTION_PRIORITY_NEVER = 4;
}
