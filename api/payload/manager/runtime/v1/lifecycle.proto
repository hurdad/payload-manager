syntax = "proto3";
package payload.manager.runtime.v1;

import "payload/manager/core/v1/placement.proto";
import "payload/manager/core/v1/id.proto";
import "payload/manager/core/v1/types.proto";
import "payload/manager/core/v1/policy.proto";

/*
  Allocate reserves placement but payload is not visible
  until CommitPayload succeeds.
*/
message AllocatePayloadRequest {
  uint64 size_bytes = 1;
  payload.manager.core.v1.Tier preferred_tier = 2;
  uint64 ttl_ms = 3;
  bool persist = 4;
  payload.manager.core.v1.EvictionPolicy eviction_policy = 5;
}

message AllocatePayloadResponse {
  payload.manager.core.v1.PayloadDescriptor payload_descriptor = 1;
}

message CommitPayloadRequest {
  payload.manager.core.v1.PayloadID id = 1;
}

message CommitPayloadResponse {
  payload.manager.core.v1.PayloadDescriptor payload_descriptor = 1;
}

/*
  force=true invalidates all active leases immediately.
*/
message DeleteRequest {
  payload.manager.core.v1.PayloadID id = 1;
  bool force = 2;
}
